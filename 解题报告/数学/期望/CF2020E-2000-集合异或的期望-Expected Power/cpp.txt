#include <bits/stdc++.h>
using namespace std;
const long double Pi = acos(-1.0);
template <class T> void fmax(T &a, T b){
    if (b > a) a = b;
}
template <class T> void fmin(T &a, T b){
    if (b < a) a = b;
}

void solve(){
    const int mod = 1e9+7;
    auto pows = [&](long long a, int b)->int{
        long long res = 1;
        while (b){
            if (b&1) res = res*a % mod;
            a = a*a % mod;
            b >>= 1;
        }
        return res;
    };
    const int mom = pows(10000, mod-2);

    int n;
    cin >> n;
    vector <int> A(n);
    for (auto &x : A) cin >> x;
    vector <int> prob(n);
    for (auto &x : prob){
        cin >> x;
        x = 1ll*x*mom % mod;
    }

    vector<vector<int>> f(2, vector<int>(1024));
    auto anti = [&](int x)->int{
        return ((1-x)%mod + mod) % mod;
    };

    f[0][0] = 1;
    for (int i = 0; i < n; ++ i){
        auto &f1 = f[i%2], &f2 = f[(i+1)%2];
        for (int j = 0; j <= 1023; ++ j){
            f2[j^A[i]] += 1ll * f1[j] * prob[i] % mod;
            f2[j^A[i]] %= mod;

            f2[j] += 1ll * f1[j] * anti(prob[i]) % mod;
            f2[j] %= mod;
        }
        fill(f1.begin(), f1.end(), 0);
    }

    int res = 0;
    auto &fn = f[n%2];
    for (int i = 0; i < 1024; ++ i){
        res += 1ll*fn[i] * i * i % mod;
        res %= mod;
    }
    cout << res << "\n";
}

int main(){
#ifdef ONLINE_JUDGE
    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);
#else
    freopen("in.txt", "rt", stdin), freopen("out.txt", "wt", stdout);
#endif
    int _ = 1;
    cin >> _;
    while (_--) solve();
    return 0;
}

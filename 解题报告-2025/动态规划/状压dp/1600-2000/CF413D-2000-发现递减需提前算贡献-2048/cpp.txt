#include <bits/stdc++.h>
using namespace std;
using i64 = long long;
using f64 = long double;
using u64 = unsigned long long;
const f64 eps = 1e-12;
const i64 inf_i64 = 1e18;
const int inf_int = 1e9;
template <class T> void fmax(T &a, const T &b){
    if (b > a) a = b;
}
template <class T> void fmin(T &a, const T &b){
    if (b < a) a = b;
}
template <class T> void print(vector <T> &A, int d = 0){
    int n = A.size();
    for (int i = 0; i < n; ++ i){
        if (i) cout << " ";
        cout << A[i]+d;
    }
    cout << "\n";
}
int jgs(f64 x){
    return x < -eps ? -1 : x > eps;
}

void solve(){
    int n, k;
    cin >> n >> k;
    const int N = 1 << k, mod = 1000000007, tar = 1 << k, msk = (1<<k) - 1;

    vector <int> A(n+1), sf(n+2);
    vector <i64> pw2(n+1, 1);
    for (int i = 1; i <= n; ++ i){
        cin >> A[i];
        pw2[i] = pw2[i-1] * 2 % mod;
    }
    for (int i = n; i > 0; -- i){
        sf[i] = sf[i+1] + (A[i] == 0);
    }

    i64 res = 0;
    vector<vector<i64>> f(n+1, vector<i64>(N));
    f[0][0] = 1;
    for (int i = 0; i < n; ++ i){
        for (int j = 0; j < tar; ++ j){
            if (A[i+1] == 0){

                if (j>>1 & 1){
                    f[i+1][4] += f[i][j], f[i+1][4] %= mod;
                } else {
                    if (j >= tar-4) res += f[i][j] * pw2[sf[i+2]] % mod, res %= mod;
                    else f[i+1][j+4] += f[i][j], f[i+1][j+4] %= mod;
                }

                if (j >= tar-2) res += f[i][j] * pw2[sf[i+2]] % mod, res %= mod;
                else f[i+1][j+2] += f[i][j], f[i+1][j+2] %= mod;

            } else if (A[i+1] == 2){

                if (j >= tar-2) res += f[i][j] * pw2[sf[i+2]] % mod, res %= mod;
                else f[i+1][j+2] += f[i][j], f[i+1][j+2] %= mod;

            } else {

                if (j>>1 & 1){
                    f[i+1][4] += f[i][j], f[i+1][4] %= mod;
                } else {
                    if (j >= tar-4) res += f[i][j] * pw2[sf[i+2]] % mod, res %= mod;
                    else f[i+1][j+4] += f[i][j], f[i+1][j+4] %= mod;
                }
                
            }
        }
    }

    cout << res << "\n";
}
 

int main(){
#ifdef ONLINE_JUDGE
    ios::sync_with_stdio(false), cin.tie(nullptr), cout.tie(nullptr);
#else
    freopen("in.txt", "rt", stdin), freopen("out.txt", "wt", stdout);
#endif
    int _ = 1;
    while (_--){
        solve();
    }
    return 0;
}
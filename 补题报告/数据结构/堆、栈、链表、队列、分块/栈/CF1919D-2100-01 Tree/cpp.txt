#include <bits/stdc++.h>
using namespace std;
using ll = long long;
const int mod = 998244353;

void solve(){
    int n;
    cin >> n;
    vector <int> A(n+1), L(n+1), R(n+1), stk(n+1);
    int c0 = 0;
    for (int i = 1; i <= n; ++ i){
        cin >> A[i];
        c0 += A[i] == 0;
    }
    if (c0 != 1) return cout << "NO\n", void();

    int top = 0;
    for (int i = 1; i <= n; ++ i){
        while (top && A[i] < A[stk[top]]){
            R[stk[top]] = i;
            -- top;
        }
        stk[++ top] = i;
    }
    while (top) R[stk[top]] = n+1, -- top;
    for (int i = n; i >= 1; -- i){
        while (top && A[i] < A[stk[top]]){
            L[stk[top]] = i;
            -- top;
        }
        stk[++ top] = i;
    }
    while (top) L[stk[top]] = 0, -- top;

    for (int i = 1; i <= n; ++ i){
        if (A[i] == 0) continue;
        bool jg = 0;
        if (L[i] == 0 && R[i] == n+1) jg = 1;
        else if (L[i] > 0 && A[L[i]] == A[i]-1) jg = 1;
        else if (R[i] <= n && A[R[i]] == A[i]-1) jg = 1;
        if (!jg){
            cout << "NO\n";
            return;
        }
    }

    cout << "YES\n";
}
 
int main(){
#ifdef ONLINE_JUDGE
    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);
#else
    freopen("in.txt", "rt", stdin), freopen("out.txt", "wt", stdout);
#endif
    int _ = 1;
    cin >> _;
    while (_--) solve();
    return 0;
}